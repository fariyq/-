<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶á‡¶®‡¶≠‡ßü‡ßá‡¶∏ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: auto; border: 1px solid #000; padding: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid black; padding: 8px; text-align: center; }
        .header { text-align: center; font-size: 20px; font-weight: bold; margin-bottom: 10px; }
        .total-section { margin-top: 10px; text-align: right; }
        .button-section { margin-top: 10px; text-align: center; }
        .no-print { display: block; }
        @media print {
            .no-print, input, button { display: none !important; } 
            body { background: white; font-size: 12px; } 
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">‡¶á‡¶Æ‡¶∞‡¶æ‡¶® ‡¶á‡¶≤‡ßá‡¶ï‡¶ü‡ßç‡¶∞‡¶®‡¶ø‡¶ï‡ßç‡¶∏ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶° ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏‡¶ø‡¶Ç ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞</div>
    <div>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: <span id="currentDate"></span> &nbsp; ‡¶∏‡¶Æ‡ßü: <span id="currentTime"></span></div>
    <div>‡¶á‡¶®‡¶≠‡ßü‡ßá‡¶∏ ‡¶®‡¶Ç: <input type="text" id="invoiceNumber" readonly></div>

    <table>
        <thead>
            <tr>
                <th>#</th>
                <th>‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th>
                <th>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th>
                <th>‡¶è‡¶ï‡¶ï ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø</th>
                <th>‡¶Æ‡ßã‡¶ü ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø</th>
                <th class="no-print">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</th>
            </tr>
        </thead>
        <tbody id="invoiceBody"></tbody>
    </table>

    <div class="total-section">
        <strong>‡¶Æ‡ßã‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ:</strong> <span id="grandTotal">0.00</span> ‡¶ü‡¶æ‡¶ï‡¶æ<br>
        <label>‡¶™‡ßç‡¶∞‡¶¶‡¶§‡ßç‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ: <input type="number" id="paidAmount" oninput="calculateDue()"></label><br>
        <strong>‡¶¨‡¶ï‡ßá‡ßü‡¶æ:</strong> <span id="dueAmount">0.00</span> ‡¶ü‡¶æ‡¶ï‡¶æ<br>
        <strong>‡¶´‡ßá‡¶∞‡¶§:</strong> <span id="returnAmount">0.00</span> ‡¶ü‡¶æ‡¶ï‡¶æ<br>
        <div id="paymentStatus" style="color: green; font-weight: bold; display: none;">‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£</div>
    </div>

    <div class="button-section">
        <button class="no-print" onclick="addItem()">‚ûï ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶£‡ßç‡¶Ø</button>
        <button class="no-print" onclick="printInvoice()">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü</button>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    let invoiceBody = document.getElementById("invoiceBody");
    let grandTotalElement = document.getElementById("grandTotal");
    let paidAmountElement = document.getElementById("paidAmount");
    let dueAmountElement = document.getElementById("dueAmount");
    let returnAmountElement = document.getElementById("returnAmount");
    let paymentStatusElement = document.getElementById("paymentStatus");
    let invoiceNumberElement = document.getElementById("invoiceNumber");

    function updateDateTime() {
        const now = new Date();
        document.getElementById("currentDate").innerText = now.toLocaleDateString('bn-BD');
        document.getElementById("currentTime").innerText = now.toLocaleTimeString('bn-BD');
        setTimeout(updateDateTime, 1000);
    }

    function generateInvoiceNumber() {
        invoiceNumberElement.value = "INV-" + Math.floor(100000 + Math.random() * 900000);
    }

    function calculateTotal() {
        let rows = document.querySelectorAll("#invoiceBody tr");
        let grandTotal = 0;

        rows.forEach((row, index) => {
            let quantityInput = row.querySelector(".quantity");
            let unitPriceInput = row.querySelector(".unitPrice");
            let totalPriceElement = row.querySelector(".totalPrice");

            let quantity = parseFloat(quantityInput.value) || 0;
            let unitPrice = parseFloat(unitPriceInput.value) || 0;
            let totalPrice = quantity * unitPrice;

            totalPriceElement.innerText = totalPrice.toFixed(2) + " ‡¶ü‡¶æ‡¶ï‡¶æ";
            grandTotal += totalPrice;

            row.querySelector(".serialNumber").innerText = index + 1;
        });

        grandTotalElement.innerText = grandTotal.toFixed(2) + " ‡¶ü‡¶æ‡¶ï‡¶æ";
        calculateDue();
    }

    function calculateDue() {
        let grandTotal = parseFloat(grandTotalElement.innerText.replace(" ‡¶ü‡¶æ‡¶ï‡¶æ", "")) || 0;
        let paidAmount = parseFloat(paidAmountElement.value) || 0;
        let dueAmount = grandTotal - paidAmount;
        let returnAmount = dueAmount < 0 ? Math.abs(dueAmount) : 0;
        dueAmount = dueAmount > 0 ? dueAmount : 0;

        dueAmountElement.innerText = dueAmount.toFixed(2) + " ‡¶ü‡¶æ‡¶ï‡¶æ";
        returnAmountElement.innerText = returnAmount.toFixed(2) + " ‡¶ü‡¶æ‡¶ï‡¶æ";
        paymentStatusElement.style.display = (dueAmount === 0 && paidAmount > 0) ? "block" : "none";
    }

    function addItem() {
        let row = document.createElement("tr");
        row.innerHTML = `<td class="serialNumber"></td>
                         <td><input type="text" class="productName"></td>
                         <td><input type="number" class="quantity" oninput="calculateTotal()"></td>
                         <td><input type="number" class="unitPrice" oninput="calculateTotal()"></td>
                         <td class="totalPrice">0.00 ‡¶ü‡¶æ‡¶ï‡¶æ</td>
                         <td class="no-print"><button class="removeBtn">‚ùå</button></td>`;

        row.querySelector(".removeBtn").addEventListener("click", function () {
            row.remove();
            calculateTotal();
        });

        invoiceBody.appendChild(row);
        calculateTotal();
    }

    function printInvoice() {
        let dueAmount = parseFloat(dueAmountElement.innerText.replace(" ‡¶ü‡¶æ‡¶ï‡¶æ", "")) || 0;
        if (dueAmount > 0) {
            alert("‡¶¨‡¶ø‡¶≤ ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶Ü‡¶õ‡ßá, ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®!");
        }
        window.print();
    }

    updateDateTime();
    generateInvoiceNumber();

    window.calculateTotal = calculateTotal;
    window.calculateDue = calculateDue;
    window.addItem = addItem;
    window.printInvoice = printInvoice;
});
</script>

</body>
</html>